{% extends "base.html" %}
{% block content %}
<div class="container">
   <h2 style="text-align: center;">Pakistan Stock Exchange Limited</h2>  
    <div id="myCarousel" class="carousel slide" data-ride="carousel">
      <!-- Indicators -->
      <ol class="carousel-indicators">
        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
        <li data-target="#myCarousel" data-slide-to="1"></li>
      </ol>
  
      <!-- Wrapper for slides -->
      <div class="carousel-inner">
        <div class="item active">
          <img src="{{ url_for('static', filename='images.jpg')}}" alt="Los Angeles" style="width:100%;">
          <div class="carousel-caption">
            <h1>INVEST IN PAKISTAN</h1>
            <h2>BUILD PAKISTAN</h2>
          </div>
        </div>
  
        <div class="item">
          <img src="{{ url_for('static', filename='0_dtiuqS8kNB66Mp5P.png')}}" alt="Chicago" style="width:100%;">
          <div class="carousel-caption">
            <h1>INVEST IN PAKISTAN</h1>
            <h2>BUILD PAKISTAN</h2>
          </div>
        </div>
      </div>
  
      <!-- Left and right controls -->
      <a class="left carousel-control" href="#myCarousel" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="right carousel-control" href="#myCarousel" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>
    <br>
    <h2 style="text-align: center;">Registered Companies</h2>
    <br>
<div class="panel panel-info">
   <!-- Default panel contents -->
   <div class="panel-heading" style="text-align: center; background-color: black; color: white; font-size: large;">MARKET SUMMARY</div>
   <div class="panel-body">

      <input class="form-control input-lg" id="myInput"  onkeyup="myFunction()" type="text" placeholder="Search Company Name... ">
      <table class="table" id="myTable">
   <thead>
     <tr>
       <th>COMPANY</th>
       <th>PRICE</th>
       <th>HIGH</th>
       <th>LOW</th>
       <th>CHANGE</th>
       <th>CHANGE IN %</th>
     </tr>
   </thead>
   <tbody >
     {% for comm in lat['response'] %}
     <tr id="tre">
         <td><a href="profile/{{ comm['id'] }}">{{comm['symbol'] }}</a></td>
         <td>{{comm['price'] }}</td>
         <td>{{comm['high'] }}</td>
         <td>{{comm['low'] }}</td>
         <td id="chg">{{comm['chg'] }}</td>
         <td>{{comm['chg_percent'] }}</td>
         <td><button><a href="profile/{{comm['id']}}">Profile</a></button><button><a href="analysis/{{comm['id']}}">Analysis</a></button></td>
     </tr>
     
     {% endfor %}
   </tbody>
 </table>
</div>
<div class="panel-footer">pakistan stock exchange summary</div>
</div>
</div>


<script>
   function myFunction() {
     var input, filter, table, tr, td, i, txtValue;
     input = document.getElementById("myInput");
     filter = input.value.toUpperCase();
     table = document.getElementById("myTable");
     tr = table.getElementsByTagName("tr");
     for (i = 0; i < tr.length; i++) {
       td = tr[i].getElementsByTagName("td")[0];
       console.log(td);
       if (td) {
         txtValue = td.textContent || td.innerText;
         if (txtValue.toUpperCase().indexOf(filter) > -1) {
           tr[i].style.display = "";
         } else {
           tr[i].style.display = "none";
         }
       }       
     }
   }
   
   
window.addEventListener("load", function(){
  table = document.getElementById("myTable");
     tr = table.getElementsByTagName("tr");
     for (i = 0; i < tr.length; i++) {
       td = tr[i].getElementsByTagName("td")[4];
       console.log(td);
       if (td) {
         txtValue = td.textContent || td.innerText;
         console.log(txtValue);
         if ( txtValue >= 0 ) {
           tr[i].setAttribute("class","success");
         } else {
           tr[i].setAttribute("class","danger");
         }
       }       
     }
});
 </script>
{% endblock %}